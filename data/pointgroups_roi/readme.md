
Suppose we have a lattice $\Lambda$ and a complex number $\alpha$ 
with the property that $\alpha \Lambda \subset \Lambda$ - 
we use this to define an elliptic curve endomorphism $z + \Lambda \mapsto \alpha z + \Lambda$.
Our goal is to find a basis for the kernel of this endomorphism.

Here is the precise set-up:

* To describe the lattice, we just need to specify $\tau$. 
We do this using the minimal polynomial of $\tau$ over the rationals: this is a quadratic of the form $ax^2 + bx + c$, with $a,b,c$ integers.
If we know the coefficients $(a,b,c)$ of the quadratic,
then $\tau$ is the unique root of $ax^2 + bx + c = 0$ in the upper half plane and $\Lambda$ is the lattice with basis $\tau, 1$.

* To describe $\alpha$, we also use a minimal polynomial. Unlike $\tau$, $\alpha$ is necessarily an algebraic integer, so the minimal polynomial of $\alpha$ has the form $x^2 - t x + n$, where $t$ is the trace of $\alpha$ and $n$ the norm of $\alpha$. To describe $\alpha$, we will specify the trace and norm. If we are given a trace and a norm, the $\alpha$ they represent is the root of $x^2 - tx + n = 0$ in the upper half plane.

* We have to choose both $\tau, \alpha$ but the choices must be compatible - that is, $\alpha$ should be an endomorphism of the lattice generated by $\tau, 1$. Fortunately, this can easily be checked using the minimal polynomials: we just have to make sure that $t^2-4n = m^2 (b^2-4ac)$ - i.e. the discriminants should have the same squarefree part, and the discriminant of the lattice should divide the discriminant of the endomorphism.

Important notes: Be careful with the sign of the trace - when we use $a,b,c$ the quadratic form is $ax^2 + bx + c$, when we use $t,n$ the quadratic is $x^2 - tx + n$.

Also, remember that $\alpha$ is always assumed to be an element of the upper half plane - we will also need to use the conjugate of $\alpha$, and the only way to tell them apart is by remembering that the sign of the imaginary part of $\alpha$ is always chosen to match the sign of the imaginary part of $\tau$.


Now, given $(a,b,c), (t,n)$, we will look for elements in the usual fundamental domain that can be used to generate the kernel of the associated endomorphism.

* We compute integers $x,y,m$ such that $\alpha = m(x+y\tau)$, with $x,y$ relatively prime. Note that $y> 0$ because $\alpha$ is in the upper half plane.
* We compute the corresponding integers for the conjugate of $\alpha$ - this just means we negate $y$ and replace $x$ with $t-x$.
* The kernel is generated by the points of order $m$, together with $\frac{m((t-x)- y \tau)}{n}$.

All of the work goes in to finding $x,y,m$ - we can just solve for those using elementary algebra.
